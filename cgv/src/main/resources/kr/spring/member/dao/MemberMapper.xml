<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.spring.member.dao.MemberMapper">
    
    <!-- 회원가입 -->
    <insert id="insertMember" parameterType="memberVO">
        INSERT INTO member (
            mem_num,
            mem_id,
            mem_pw,
            mem_name,
            mem_phone,
            mem_email,
            reg_date,
            auth,
            point
        ) VALUES (
            member_seq.nextval,
            #{mem_id},
            #{mem_pw},
            #{mem_name},
            #{mem_phone},
            #{mem_email},
            SYSDATE,
            'ROLE_USER',
            0
        )
    </insert>
    
    <!-- 아이디 중복 체크 -->
    <select id="checkId" parameterType="string" resultType="integer">
        SELECT COUNT(*) FROM member WHERE mem_id = #{mem_id}
    </select>
    
    <!-- 로그인 -->
    <select id="selectMember" parameterType="string" resultType="memberVO">
        SELECT * FROM member WHERE mem_id = #{mem_id}
    </select>
    
    <!-- 회원정보 수정 -->
    <update id="updateMember" parameterType="memberVO">
        UPDATE member SET
            mem_name = #{mem_name},
            mem_phone = #{mem_phone},
            mem_email = #{mem_email}
        WHERE mem_num = #{mem_num}
    </update>
    
    <!-- 비밀번호 변경 -->
    <update id="updatePassword">
        UPDATE member SET mem_pw = #{mem_pw}
        WHERE mem_num = #{mem_num}
    </update>
    
    <!-- 회원 탈퇴 -->
    <delete id="deleteMember" parameterType="integer">
        DELETE FROM member WHERE mem_num = #{mem_num}
    </delete>
    
    <!-- 아이디 찾기 -->
    <select id="findId" resultType="string">
        SELECT mem_id FROM member 
        WHERE mem_name = #{mem_name} AND mem_email = #{mem_email}
    </select>
    
    <!-- 비밀번호 찾기를 위한 회원 확인 -->
    <select id="checkMemberForPw" resultType="integer">
        SELECT COUNT(*) FROM member 
        WHERE mem_id = #{mem_id} AND mem_email = #{mem_email}
    </select>
    
    <!-- 회원번호로 회원정보 조회 -->
    <select id="selectMemberByNum" parameterType="integer" resultType="memberVO">
        SELECT * FROM member WHERE mem_num = #{mem_num}
    </select>
    
</mapper>
